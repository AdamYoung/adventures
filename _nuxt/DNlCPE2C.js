import{r as a,K as G,n as de,f as ve,g as ce,o as i,c as s,z as S,a as t,d as z,b as J,w as he,G as fe,D as W,F as pe,p as ge,t as me,M as ye,B as q,L as U,H as ke}from"./bWthWSnp.js";import{_ as we}from"./DlAUqK2U.js";const be={class:"slideshow"},Te=["src"],xe={key:"current",class:"slide current"},Me=["src"],_e=["src"],Se={class:"controls"},Ce={key:0,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Le={key:1,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Ve={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},Ae={key:0,d:"M12 6L8 10H4v4h4l4 4V6z M16 8.5a5 5 0 0 1 0 7 M19 6a8 8 0 0 1 0 12","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},Be={key:1,d:"M12 6L8 10H4v4h4l4 4V6z M18 12l3-3 M18 12l3 3","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},ze={viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},We={key:0},je={key:1},Ke={__name:"Story_new",props:{slides:{type:Array,required:!0,validator:f=>f.every(v=>typeof v.text=="string"&&(typeof v.image=="string"||typeof v.video=="string"))},musicSrc:{type:String,default:""}},setup(f){const v=f,n=a(null),C=a(!1),r=a(0),j=a([]),K=a(-1),y=a(!1),b=a(!1),d=G(()=>v.slides[r.value]);G(()=>r.value<v.slides.length-1?v.slides[r.value+1]:null);const u=a(null),c=a(!1),p=a(!0),L=a(!0),g=a(!1),o=a(null),D=a(!1),m=a(!1),T=a(!1),x=a(null),M=a(null),E=a(null),I=a(null),N=a(!1),P=a(0),F=a(0),k=a(!0),H=a(!1),O=a(!0),h=a(!1),_=a(!1);function Q(){_.value=!_.value,n.value&&(_.value?n.value.pause():k.value||n.value.play().catch(l=>console.warn("Background music playback failed:",l)))}de(async()=>{if("speechSynthesis"in window)try{const l=new Audio;l.muted=!0,await l.play(),H.value=!0,k.value=!1,R()}catch{H.value=!1,k.value=!0}else console.error("Speech synthesis not supported")});function R(){k.value=!1,n.value&&C.value&&!_.value&&(n.value.volume=.2,n.value.play().catch(l=>console.warn("Background music playback failed:",l))),O.value?(O.value=!1,requestAnimationFrame(()=>{clearTimeout(I.value),I.value=setTimeout(()=>{w()},100)})):w()}function X(){y.value=!1,c.value=!1,u.value?(u.value.currentTime=0,setTimeout(()=>{c.value=!0,u.value.play(),w()},500)):w()}ve(d,()=>{},{immediate:!0}),ce(()=>{clearTimeout(x.value),clearTimeout(M.value),clearTimeout(E.value),clearTimeout(I.value),stop(),n.value&&n.value.pause()});function Y(){u.value&&(u.value.pause(),u.value.currentTime=0)}function Z(){o.value&&(h.value=!1,o.value.pause(),o.value.currentTime=0)}function w(){if(j.value=d.value.text.split(" "),K.value=-1,y.value=!1,c.value=!1,L.value=!0,D.value=!1,m.value=!1,T.value=!1,N.value=!1,c.value=!1,P.value=0,F.value=0,d.value.video&&u.value){u.value.load();const l=()=>{!g.value&&o.value&&!h.value?(h.value=!0,o.value.load()):(c.value=!0,u.value.play().catch(e=>console.warn("Video playback failed:",e)))};u.value.removeEventListener("loadeddata",l),u.value.addEventListener("loadeddata",l,{once:!0})}else!g.value&&o.value&&!h.value?(h.value=!0,o.value.load(),o.value.play().catch(l=>{console.warn("Audio playback failed:",l),h.value=!1})):p.value&&(clearTimeout(M.value),M.value=setTimeout(()=>V(),3e3));b.value=!1}function ee(){if(!u.value||!o.value)return 0;const l=P.value,e=F.value;return e>l?(e-l)*1e3:0}function ae(){N.value=!0,u.value&&(P.value=u.value.duration)}function te(){if(h.value&&o.value){if(D.value=!0,F.value=o.value.duration,o.value.currentTime=0,o.value.play().catch(l=>console.warn("Audio playback failed:",l)),d.value.video&&u.value&&N.value){const l=ee();clearTimeout(E.value),E.value=setTimeout(()=>{c.value=!0,u.value.currentTime=0,u.value.play().catch(e=>console.warn("Video playback failed:",e))},l)}h.value=!1}}function le(){h.value=!1,m.value=!0,L.value=!1,$()}function oe(){T.value=!0,$()}function $(){(m.value||g.value)&&(!d.value.video||T.value)&&(y.value=!0,p.value&&(clearTimeout(M.value),M.value=setTimeout(()=>V(),1500)))}function V(){r.value<v.slides.length-1&&!b.value&&(b.value=!0,c.value=!1,m.value=!1,T.value=!1,r.value++,clearTimeout(x.value),x.value=setTimeout(()=>{w()},500))}function ue(){r.value>0&&!b.value&&(b.value=!0,c.value=!1,Y(),Z(),m.value=!1,T.value=!1,r.value--,clearTimeout(x.value),x.value=setTimeout(()=>{w()},500))}function ie(){p.value=!p.value,p.value&&y.value&&(u.value?(c.value=!0,u.value.play().catch(l=>console.warn("Video playback failed:",l))):V())}function se(){g.value=!g.value,g.value?(o.value&&(o.value.pause(),m.value=!0,$()),n.value&&n.value.pause()):(o.value&&D.value&&(m.value=!1,o.value.play(),L.value=!0),n.value&&C.value&&n.value.play())}function ne(){if(o.value){const l=o.value.currentTime,e=o.value.duration,A=j.value.length,B=Math.floor(l/e*A);K.value=Math.min(B,A-1)}}function re(){C.value=!0,k.value||(n.value.volume=.2,n.value.play().catch(l=>console.warn("Background music playback failed:",l)))}return(l,e)=>(i(),s("div",be,[f.musicSrc?(i(),s("audio",{key:0,ref_key:"backgroundMusic",ref:n,src:f.musicSrc,loop:"",preload:"auto",onLoadeddata:re},null,40,Te)):S("",!0),k.value&&!H.value?(i(),s("div",{key:1,class:"interaction-overlay",onClick:R},e[0]||(e[0]=[t("button",{class:"start-button","aria-label":"Start presentation"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M8 5v14l11-7z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})]),t("span",null,[z("Start"),t("br"),z("Story")])],-1)]))):S("",!0),J(ye,{name:"fade",mode:"out-in"},{default:he(()=>[d.value?(i(),s("div",xe,[t("div",{class:"slide-media",style:fe({backgroundImage:`url(${d.value.image||""})`})},null,4),d.value.video?(i(),s("video",{key:0,ref_key:"currentVideo",ref:u,class:W(["slide-media",{"video-ready":c.value}]),src:d.value.video,preload:"auto",muted:"",playsinline:"",loop:!1,onLoadeddata:ae,onEnded:oe},null,42,Me)):S("",!0),d.value.audio?(i(),s("audio",{key:1,ref_key:"currentAudio",ref:o,src:d.value.audio,preload:"auto",onLoadeddata:te,onEnded:le,onTimeupdate:ne},null,40,_e)):S("",!0),t("div",{class:W(["slide-text",{"fade-out":!L.value}])},[(i(!0),s(pe,null,ge(j.value,(A,B)=>(i(),s("span",{key:`${r.value}-${B}`,class:W({highlight:B===K.value})},me(A),3))),128))],2)])):S("",!0)]),_:1}),t("div",Se,[q(t("button",{class:"control-button left",onClick:ue,"aria-label":"Previous slide"},e[1]||(e[1]=[t("svg",{class:"chevron",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M15.5 5.5L8.5 12l7 6.5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),512),[[U,r.value>0]]),q(t("button",{class:W(["control-button right",{pulse:y.value}]),onClick:V,"aria-label":"Next slide"},e[2]||(e[2]=[t("svg",{class:"chevron",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M8.5 5.5L15.5 12l-7 6.5","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),2),[[U,r.value<f.slides.length-1]])]),t("button",{class:"control-button auto-play",onClick:ie,"aria-label":"Toggle auto play"},[p.value?(i(),s("svg",Le,e[4]||(e[4]=[t("path",{d:"M6 4h4v16H6V4zM14 4h4v16h-4V4z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))):(i(),s("svg",Ce,e[3]||(e[3]=[t("path",{d:"M5 3l14 9-14 9V3z","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))),e[5]||(e[5]=t("span",null,[z("Auto"),t("br"),z("Play")],-1))]),q(t("button",{class:"control-button replay",onClick:X,"aria-label":"Replay slide"},e[6]||(e[6]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("path",{d:"M3 12a9 9 0 1 1 2.83 6.54M3 12V8m0 4h4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]),512),[[U,y.value&&!p.value]]),t("button",{class:"control-button speech-toggle",onClick:se,"aria-label":"Toggle speech"},[(i(),s("svg",Ve,[g.value?(i(),s("path",Be)):(i(),s("path",Ae))]))]),t("button",{class:"control-button music-toggle",onClick:Q,"aria-label":"Toggle background music"},[(i(),s("svg",ze,[e[9]||(e[9]=t("path",{d:"M9 18V6l12-2v12 M9 9h4","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)),_.value?(i(),s("g",je,e[8]||(e[8]=[t("circle",{cx:"17",cy:"16",r:"3","stroke-width":"2"},null,-1),t("line",{x1:"14",y1:"13",x2:"20",y2:"19","stroke-width":"2","stroke-linecap":"round"},null,-1)]))):(i(),s("g",We,e[7]||(e[7]=[t("circle",{cx:"17",cy:"16",r:"3","stroke-width":"2"},null,-1)])))]))])]))}},De=we(Ke,[["__scopeId","data-v-3f0a9187"]]),Ne={__name:"storyNew",setup(f){var v=[{image:"page1.png",audio:"page1.mp3",video:"page1.mp4",videoStart:4.2,text:"Mya and Khita were ready to go, With giggles and grins that started to show. 'Letâ€™s explore the forest, with tall whispering trees, With secrets that dance on the cool, gentle breeze!'"},{image:"page2.png",audio:"page2.mp3",video:"page2.mp4",videoStart:5.5,text:"They skipped through the meadow, so happy and free, With butterflies dancing as far as they'd see. Khita ran fast, her tail held high, While Mya spun round with a laugh and a sigh. 'Oh Khita, just look! The forest is near! Let's follow the butterflies our path is clear!'"},{image:"page3.png",audio:"page3.mp3",video:"page3.mp4",videoStart:6.2,text:"Into the forest, the sunlight grew dim, The trees whispered secrets, a magical hymn. Mya walked softly, her heart filled with cheer, While Khita's ears twitched adventure was near! Through rustling leaves and a soft earthy floor, They came to a river, with stories galore."},{image:"page4.png",audio:"page4.mp3",video:"page4.mp4",videoStart:5.4,text:"They found a big leaf by the river's cool side, 'Let's use it,' said Mya, 'for a magical ride!' With Khita aboard and the water aglow, They floated along where the soft currents flow. The fish swam beneath, with a wiggle and flip, While Khita sat proud, the captain of their ship!"},{image:"page5.png",audio:"page5.mp3",video:"page5.mp4",videoStart:6.2,text:"At the base of the tree, so sturdy and tall, Mya gazed upward, feeling so small. 'Let's climb to the top and see what's around!' Khita barked twice and leapt from the ground. With paws and hands, they started their quest, For views from the treetops the very best!"},{image:"page6.png",audio:"page6.mp3",video:"page6.mp4",videoStart:7.1,text:"High in the branches, they sat side by side, With mountains and valleys stretching far and wide. The rivers below sparkled bright in the sun, And colorful birds made their flight look like fun. 'Oh Khita, just look! The world feels so wide!' Mya whispered in wonder, her heart full of pride."},{image:"page7.png",audio:"page7.mp3",video:"page7.mp4",videoStart:4.9,text:"As the sun went to sleep and the stars filled the skies, The forest lit up with bright fireflies. Mya skipped gently, her heart feeling light, While Khita chased bugs that blinked in the night. 'What a day we have had, so much to explore!' Mya laughed as they walked back home once more."}];return(n,C)=>{const r=De;return i(),s("div",null,[J(r,{slides:ke(v),musicSrc:"story_background1.mp3"},null,8,["slides"])])}}};export{Ne as default};
